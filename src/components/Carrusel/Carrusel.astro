---
import "@splidejs/splide/css";
import { getMergedInfo } from "@services/githubAPI";
import { type RepositoryInfo } from "@services/githubAPI";
import Button from "@components/Button/Button.astro";
import Icon from "@components/Icon/Icon.astro";
import Card from "@components/Card/Card.astro";
import SkillIcon from "@components/SkillIcon/SkillIcon.astro";
import { info } from "@helpers/data";

const repositories = await getMergedInfo();
---

<div class="splide" role="group">
  <div class="splide__track">
    <ul class="splide__list">
      <li class="splide__slide">
        <div id="sobre-mi" class="pb-12 text-white">
          <h1 class="text-xl font-bold">Sobre mi</h1>
          <div class="@container flex flex-col items-center justify-center">
            <p class="w-[75cqw] mt-6 text-xl text-justify whitespace-pre-line">
              {info.aboutMe.join("\n\n")}
            </p>
            <br />
            <Button name="CV" link={info.links.CV}>
              <Icon name="CV" icon="/CV_Icon.svg" />
            </Button>
          </div>
        </div>
      </li>
      <li class="splide__slide">
        <div id="formacion" class="pb-12 text-white">
          <h1 class="text-xl font-bold">Formación</h1>
          {
            (
              <div class="inline-grid grid-cols-3 gap-4 mt-6">
                <Card title="Escuela secundaria" cardtype={false}>
                  <div class="inline-grid grid-rows-2 select-none">
                    <h4 class="text-lg font-medium p-4">
                      {info.formacion.secundaria.titulo}
                    </h4>
                    <p class="text-sm">
                      {info.formacion.secundaria.institucion}
                      <br/>
                      {info.formacion.secundaria.fechaInicio}
                      -
                      {info.formacion.secundaria.fechaFin}
                      <br/>
                      {info.formacion.secundaria.lugar}
                    </p>
                  </div>
                </Card>
                <Card title="Facultad" cardtype={false}>
                  <div class="inline-grid grid-rows-2 select-none">
                    <h4 class="text-lg font-medium p-4">
                      {info.formacion.facultad.titulo}
                    </h4>
                    <p class="text-sm">
                      {info.formacion.facultad.institucion}
                      <br/>
                      {info.formacion.facultad.fechaInicio}
                      -
                      {info.formacion.facultad.fechaFin}
                      <br/>
                      {info.formacion.facultad.lugar}
                    </p>
                  </div>
                </Card>
                <Card title="Experiencia laboral" cardtype={false}>
                  <div class="grid gap-1 select-none p-0">
                    <h4 class="text-lg font-medium">
                      {info.formacion.experienciaLaboral.puesto}
                    </h4>
                    <p class="text-sm">
                      {info.formacion.experienciaLaboral.empresa}
                      <br/>
                      {info.formacion.experienciaLaboral.fechaInicio}
                      -
                      {info.formacion.experienciaLaboral.fechaFin}
                      <br/>
                      {info.formacion.experienciaLaboral.lugar}
                    </p>
                  </div>
                </Card> 
              </div>
            )
          }
        </div>
      </li>
      <li class="splide__slide">
        <div id="proyectos" class="pb-12 text-white">
          <h1 class="text-xl font-bold">Últimos 4 proyectos</h1>
          <div class="inline-grid grid-cols-2 grid-rows-2 gap-4 mt-6">
            {
              repositories.map((repository: RepositoryInfo) => (
                <a href={repository.html_url}>
                  <Card title={repository.name}>
                    {repository.description}
                    <br />
                    <SkillIcon
                      iconUrl={repository.languages?.map(
                        (language: string) => language
                      )}
                      size={7}
                    />
                  </Card>
                </a>
              ))
            }
          </div>
        </div>
      </li>
      <li class="splide__slide">
        <div id="contacto" class="pb-12 text-white text-center">
          <h1 class="text-xl font-bold mb-6">Contacto</h1>

          <div class="inline-grid gap-4 items-center justify-center">
            <Button name="Gmail" link={info.links.gmail}>
              <Icon name="Gmail" icon="/Gmail_Icon.svg" />
            </Button>

            <Button name="LinkedIn" link={info.links.linkedin}>
              <Icon name="LinkedIn" icon="/Linkedin_Icon.svg" />
            </Button>

            <Button name="Github" link={info.links.github}>
              <Icon name="Github" icon="/Github_Icon.svg" />
            </Button>
          </div>
        </div>
      </li>
    </ul>

    <script src="@ts/carrusel.ts"></script>
  </div>
</div>
